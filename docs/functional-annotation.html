<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Functional Annotation | Complete Microbiome Analysis</title>
  <meta name="description" content="A work-in-progress" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Functional Annotation | Complete Microbiome Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A work-in-progress" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Functional Annotation | Complete Microbiome Analysis" />
  
  <meta name="twitter:description" content="A work-in-progress" />
  

<meta name="author" content="Alana Schick" />


<meta name="date" content="2022-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="remove-contaminants.html"/>
<link rel="next" href="alpha-diversity.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Complete Microbiome Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#overview-of-sections"><i class="fa fa-check"></i>Overview of sections</a></li>
</ul></li>
<li class="part"><span><b>I Part 1: Samples to Sequences</b></span></li>
<li class="chapter" data-level="1" data-path="experimental-design-considerations.html"><a href="experimental-design-considerations.html"><i class="fa fa-check"></i><b>1</b> Experimental Design Considerations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="experimental-design-considerations.html"><a href="experimental-design-considerations.html#amplicon-versus-shotgun"><i class="fa fa-check"></i><b>1.1</b> Amplicon versus Shotgun</a></li>
<li class="chapter" data-level="1.2" data-path="experimental-design-considerations.html"><a href="experimental-design-considerations.html#s-resources"><i class="fa fa-check"></i><b>1.2</b> 16S Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="power-analyses.html"><a href="power-analyses.html"><i class="fa fa-check"></i><b>2</b> Power Analyses</a></li>
<li class="chapter" data-level="3" data-path="sequencing-samples.html"><a href="sequencing-samples.html"><i class="fa fa-check"></i><b>3</b> Sequencing samples</a></li>
<li class="part"><span><b>II Working with Sequence Data</b></span></li>
<li class="chapter" data-level="4" data-path="filtering-and-cleaning.html"><a href="filtering-and-cleaning.html"><i class="fa fa-check"></i><b>4</b> Filtering and cleaning</a></li>
<li class="chapter" data-level="5" data-path="generating-abundance-tables.html"><a href="generating-abundance-tables.html"><i class="fa fa-check"></i><b>5</b> Generating Abundance Tables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="generating-abundance-tables.html"><a href="generating-abundance-tables.html#dada2-notes"><i class="fa fa-check"></i><b>5.1</b> Dada2 notes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="remove-contaminants.html"><a href="remove-contaminants.html"><i class="fa fa-check"></i><b>6</b> Remove Contaminants</a></li>
<li class="chapter" data-level="7" data-path="functional-annotation.html"><a href="functional-annotation.html"><i class="fa fa-check"></i><b>7</b> Functional Annotation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-annotation.html"><a href="functional-annotation.html#amplicon-sequences"><i class="fa fa-check"></i><b>7.1</b> Amplicon sequences</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="functional-annotation.html"><a href="functional-annotation.html#picrust2-notes"><i class="fa fa-check"></i><b>7.1.1</b> Picrust2 notes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functional-annotation.html"><a href="functional-annotation.html#shotgun-sequences"><i class="fa fa-check"></i><b>7.2</b> Shotgun sequences</a></li>
</ul></li>
<li class="part"><span><b>III Working with Abundance Tables</b></span></li>
<li class="chapter" data-level="8" data-path="alpha-diversity.html"><a href="alpha-diversity.html"><i class="fa fa-check"></i><b>8</b> Alpha diversity</a></li>
<li class="chapter" data-level="9" data-path="beta-diversity.html"><a href="beta-diversity.html"><i class="fa fa-check"></i><b>9</b> Beta Diversity</a></li>
<li class="chapter" data-level="10" data-path="differential-abundance.html"><a href="differential-abundance.html"><i class="fa fa-check"></i><b>10</b> Differential Abundance</a>
<ul>
<li class="chapter" data-level="10.1" data-path="differential-abundance.html"><a href="differential-abundance.html#corncob-notes"><i class="fa fa-check"></i><b>10.1</b> Corncob notes</a></li>
<li class="chapter" data-level="10.2" data-path="differential-abundance.html"><a href="differential-abundance.html#deseq2-notes"><i class="fa fa-check"></i><b>10.2</b> DESeq2 notes</a></li>
<li class="chapter" data-level="10.3" data-path="differential-abundance.html"><a href="differential-abundance.html#metagenomeseq"><i class="fa fa-check"></i><b>10.3</b> metagenomeSeq</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="normalization-methods.html"><a href="normalization-methods.html"><i class="fa fa-check"></i><b>11</b> Normalization Methods</a></li>
<li class="chapter" data-level="12" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>12</b> Multivariate Analysis</a></li>
<li class="part"><span><b>IV Advanced Topics</b></span></li>
<li class="chapter" data-level="13" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html"><i class="fa fa-check"></i><b>13</b> Reproducible Workflows</a>
<ul>
<li class="chapter" data-level="13.1" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html#snakemake"><i class="fa fa-check"></i><b>13.1</b> Snakemake</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multiomic-methods.html"><a href="multiomic-methods.html"><i class="fa fa-check"></i><b>14</b> Multiomic Methods</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multiomic-methods.html"><a href="multiomic-methods.html#correlation-analysis"><i class="fa fa-check"></i><b>14.1</b> Correlation Analysis</a></li>
<li class="chapter" data-level="14.2" data-path="multiomic-methods.html"><a href="multiomic-methods.html#network-analysis"><i class="fa fa-check"></i><b>14.2</b> Network Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Complete Microbiome Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functional-annotation" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Functional Annotation<a href="functional-annotation.html#functional-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="amplicon-sequences" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Amplicon sequences<a href="functional-annotation.html#amplicon-sequences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="picrust2-notes" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Picrust2 notes<a href="functional-annotation.html#picrust2-notes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How it works:</p>
<p>Picrust2 has a reference database of annotated genomes placed on a phylogenetic tree, including a model of how well conserved genes are across the tree. In other words, given how close two species are on the tre, how likely is it that a given gene will be shared, for all genes. The amplicon sequences are placed on the tree, then Picrust2 estimates what genes that species is likely to have based on the annotated genomes of the species near it on the tree and how well conserved those genes are. Doing this for all amplicon sequences will estimate the functional content of a sample.</p>
<p>The problems arise when either A) a species has conserved amplicon sequence but substantially variable gene content, so even if you know where it goes on the tree you cant make a good guess about the presence or absence of those variable genes, or B) your observed amplicon sequence comes from a place on the tree without a lot of information - it’s nearest neighbors aren’t very near or you don’t have enough information to estimate gene conservation well - so you end up with highly speculative, weak estimates, which are probably largely incorrect. If either of those problem cases applies to highly abundant species/16s sequences in your sample, your overall picture of the samples functional content can be way off.</p>
<p>On the other hand, if your sample is mainly comprised of very well characterized species which are well represented in the reference data and which don’t have a lot of intraspecies functional variation, you can infer a remarkably accurate functional profile of your sample using picrust. (In terms of functional capacity/genes present at least; you don’t know anything about what’s actually being expressed… But shotgun metagenomics doesn’t help you there, either.)</p>
</div>
</div>
<div id="shotgun-sequences" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Shotgun sequences<a href="functional-annotation.html#shotgun-sequences" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="remove-contaminants.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="alpha-diversity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/annotate-functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["complete-microbiome-analysis.pdf", "complete-microbiome-analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
